{"filter":false,"title":"index.js","tooltip":"/routes/index.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":2,"column":0},"end":{"row":3,"column":37},"action":"insert","lines":["var passport = require(\"passport\");","var User = require(\"../models/user\");"],"id":2},{"start":{"row":9,"column":6},"end":{"row":11,"column":6},"action":"insert","lines":["q.flash(\"url\");          //clear req.flash(\"url\")","    req.flash(\"url\", req.path);","    re"]},{"start":{"row":11,"column":29},"end":{"row":11,"column":30},"action":"insert","lines":[";"]},{"start":{"row":14,"column":0},"end":{"row":86,"column":3},"action":"insert","lines":["// show register form","router.get(\"/register\", function(req, res){","   res.render(\"register\"); ","});","","// show about page","router.get(\"/about\", function(req, res){","   req.flash(\"url\");          //clear req.flash(\"url\")","   req.flash(\"url\", req.path);","   res.render(\"about\"); ","});","// show contact page","router.get(\"/contact\", function(req, res){","   req.flash(\"url\");          //clear req.flash(\"url\")","   req.flash(\"url\", req.path);","   res.render(\"contact\"); ","});","// show FAQs page","router.get(\"/FAQs\", function(req, res){","   req.flash(\"url\");          //clear req.flash(\"url\")","   req.flash(\"url\", req.path);","   res.render(\"FAQs\"); ","});","","//handle sign up logic","router.post(\"/register\", function (req, res) {","    if(req.body.password != req.body.confirmPassword){","        res.render(\"register\", {error: \"Passwords don't match!\"});","    } else{","        var newUser = new User({","            username: req.body.username,","            email: req.body.email,","            fullName : req.body.fullName","        });","        User.register(newUser, req.body.password, function(err, user){","            if(err){","                req.flash(\"error\", err.message);","                res.redirect(\"/register\");","            } else {","                passport.authenticate(\"local\")(req, res, function(){","                    req.flash(\"success\", \"You registered sucessfully! Welcome to the Tutor Exchange Website! \" + user.fullName);","                    res.redirect(\"/posts\");","                });","            }","        });","    }","});","","//show login form","router.get(\"/login\", function(req, res){","   var url =req.flash(\"url\")[0];","   req.flash(\"url\", url);","   res.render(\"login\");","});","","//handling login logic","router.post(\"/login\",  passport.authenticate(\"local\", {failureRedirect: \"/login\", failureFlash: true}), function(req, res){","        req.flash(\"success\", \"Hello! \"+req.user.fullName)","        var path = req.flash(\"url\")[0];","        if(!path || path ==\"\"){","            res.redirect(\"/\");","        } else {","            res.redirect(path);","        }","        }",");","","// logout route","router.get(\"/logout\", function(req, res){","   req.logout();","   req.flash(\"success\", \"You have logged out.\");","   res.redirect(\"/posts\");","});"]}]]},"ace":{"folds":[],"scrolltop":84,"scrollleft":0,"selection":{"start":{"row":1,"column":22},"end":{"row":1,"column":22},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":47,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1497079215000,"hash":"e82232c5f73036d37804ad0b5b3f1e9853abf086"}